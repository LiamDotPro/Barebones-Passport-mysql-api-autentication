{"version":3,"sources":["../../lib/userFunctions.js"],"names":["authentication","email","password","checkForDuplicateAccount","toLowerCase","then","res","payload","length","encryptPassword","pass","createAccount","msg","validateUser"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;;;;;;AAEA;;;;;;;;IAQqBA,c;;;AAEjB,8BAAc;AAAA;;AAAA;AAEb;;AAED;;;;;;;;;;;;;;;qCAWaC,K,EAAOC,Q,EAAU;AAAA;;AAC1B,mBAAO,KAAKC,wBAAL,CAA8BF,MAAMG,WAAN,EAA9B,EAAmDC,IAAnD,CAAwD,UAACC,GAAD,EAAS;AACpE,oBAAIA,IAAIC,OAAJ,KAAgB,CAApB,EAAuB;AACnB,wBAAIL,SAASM,MAAT,IAAmB,CAAvB,EAA0B;AACtB,+BAAO,OAAKC,eAAL,CAAqBP,QAArB,EAA+BG,IAA/B,CAAoC,UAACK,IAAD,EAAU;AACjD,mCAAO,OAAKC,aAAL,CAAmBV,MAAMG,WAAN,EAAnB,EAAwCM,IAAxC,EAA8CL,IAA9C,CAAmD,YAAM;AAC5D,uCAAO;AACHO,yCAAK,sBADF;AAEHL,6CAASD,IAAIC;AAFV,iCAAP;AAIH,6BALM,CAAP;AAMH,yBAPM,CAAP;AAQH,qBATD,MASO;AACH,+BAAO;AACHK,iCAAK;AADF,yBAAP;AAGH;AACJ,iBAfD,MAeO;AACH,2BAAO;AACHA,6BAAKN,IAAIM;AADN,qBAAP;AAGH;AAEJ,aAtBM,CAAP;AAuBH;;AAED;;;;;;;;;;8BAOMX,K,EAAOC,Q,EAAU;AACnB,mBAAO,KAAKW,YAAL,CAAkBZ,KAAlB,EAAyBC,QAAzB,EAAmCG,IAAnC,CAAwC,UAACC,GAAD,EAAS;AACpD,uBAAOA,GAAP;AACH,aAFM,CAAP;AAGH;;;;;;kBAtDgBN,c","file":"userFunctions.js","sourcesContent":["import Promise from 'bluebird';\r\nimport baseUserFunctions from \"./baseUserFunctions\";\r\n\r\n/**\r\n * Payload Numbering\r\n *\r\n * 0 Success\r\n * 1 Failure\r\n * 10 Account Creation\r\n * 11 Successful Login\r\n */\r\nexport default class authentication extends baseUserFunctions {\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * List of error handling and checks.\r\n     *\r\n     * Duplicate Entry Test\r\n     * length Test\r\n     * @todo test with postman for if extra length is needed, also implenting special char check regexp\r\n     * @param email\r\n     * @param password\r\n     * @returns {Promise.<TResult>}\r\n     * @constructor\r\n     */\r\n    registerUser(email, password) {\r\n        return this.checkForDuplicateAccount(email.toLowerCase()).then((res) => {\r\n            if (res.payload === 0) {\r\n                if (password.length >= 6) {\r\n                    return this.encryptPassword(password).then((pass) => {\r\n                        return this.createAccount(email.toLowerCase(), pass).then(() => {\r\n                            return {\r\n                                msg: 'New Account Created.',\r\n                                payload: res.payload\r\n                            }\r\n                        })\r\n                    });\r\n                } else {\r\n                    return {\r\n                        msg: 'Password not long enough'\r\n                    }\r\n                }\r\n            } else {\r\n                return {\r\n                    msg: res.msg\r\n                }\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Separate method from the attempt to validate specifically so we can add extra\r\n     * checks and further integration later if without worrying about moving stuff\r\n     * to methods.\r\n     * @param email\r\n     * @param password\r\n     */\r\n    login(email, password) {\r\n        return this.validateUser(email, password).then((res) => {\r\n            return res;\r\n        })\r\n    }\r\n\r\n}"]}